<VirtualHost *>
  ServerName ccdb.ccnmtl.columbia.edu
  ServerAlias cckc.ccnmtl.columbia.edu
  ServerAlias calculator.law.columbia.edu
  ServerAdmin ccnmtl-sysadmin@columbia.edu
  CustomLog /var/log/apache2/ccdb/access.log combined
  ErrorLog /var/log/apache2/ccdb/error.log

  SetEnv DJANGO_SETTINGS_MODULE ccdb.settings_production

  WSGIDaemonProcess site-ccdb user=pusher group=pusher threads=5 python-path=/var/www/ccdb/ccdb/ve/lib/python2.5/site-packages
  WSGIProcessGroup site-ccdb
  WSGIReloadMechanism Process

  WSGIScriptAlias / /var/www/ccdb/ccdb/apache/django.wsgi

  Alias /site_media/ /var/www/ccdb/ccdb/media/
  Alias /favicon.ico /var/www/ccdb/ccdb/media/favicon.ico
  Alias /robots.txt /var/www/ccdb/ccdb/media/robots.txt

  <IfModule mod_rewrite.c>
    RewriteEngine On
    ServerSignature Off
    Options +FollowSymLinks
    RewriteCond %{HTTP_USER_AGENT} search.msn.com/msnbot [OR]
    RewriteCond %{HTTP_USER_AGENT} ws.daum.net/ [OR]
    RewriteCond %{HTTP_USER_AGENT} help.yahoo.com/help/us/ysearch/slurp
    RewriteRule ^(.*)$ - [F,L]
  </IfModule>

  <Directory /var/www/ccdb/ccdb/media/>
    Order deny,allow
    Allow from all
    FileETag None
    ExpiresActive on
    ExpiresDefault "access plus 10 years"
    AddOutputFilterByType DEFLATE text/css application/x-javascript
  </Directory>
 
  Alias /media/ /var/www/ccdb/ccdb/ve/lib/python2.5/site-packages/django/contrib/admin/media/
  <Directory /var/www/ccdb/ccdb/ve/lib/python2.5/site-packages/django/contrib/admin/media/>
    Order deny,allow
    Allow from all
    FileETag None
    ExpiresActive on
    ExpiresDefault "access plus 10 years"
    AddOutputFilterByType DEFLATE text/css application/x-javascript
  </Directory>

  Alias /uploads/ /var/www/ccdb/uploads/
  <Directory /var/www/ccdb/uploads/>
    Order deny,allow
    Allow from all
    FileETag None
    ExpiresActive on
    ExpiresDefault "access plus 10 years"
    AddOutputFilterByType DEFLATE text/css application/x-javascript
  </Directory>

</VirtualHost>
