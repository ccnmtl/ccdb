{% extends "law/edit_base.html" %}
{% load markup %}

{% block content %}
{{ block.super }}
<h2>Snapshot: {{ snapshot.label }}</h2>
<p>{{ snapshot.description }}</p>

{% if snapshot.cloneable %}
<form action="clone/" method="post">
  <fieldset><legend>clone this snapshot</legend>
    <table>
      <tr>
	<th>label of new snapshot:</th>
	<td><input type="text" name="label" /></td>
      </tr>
      <tr>
	<th>description</th>
	<td>
	  <textarea name="description"></textarea>
	</td>
      </tr>
    </table>
    <input type="submit" value="clone" />
</fieldset>
</form>
{% endif %}

{% ifequal snapshot.status "in progress" %}
<form action="approve/" method="post">
<input type="submit" value="promote this snapshot to production" />
</form>
{% endifequal %}

<h2>History</h2>

  {% for event in snapshot.event_set.all %}
  {% ifchanged %}<h3>{{ event.created|date:"D, d M Y" }}</h3>{% endifchanged %}
  <div class="event">
    <div class="byline">
      {{ event.created|date:"H:i" }} by {{ event.user.first_name }} {{ event.user.last_name }}
    </div>
    <div class="description">{{ event.description|markdown }}</div>
    <div class="note">{{ event.note|markdown }}</div>
  </div>
  {% endfor %}

{% endblock %}
