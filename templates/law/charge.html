{% extends "base.html" %}

{% block title %}{{ charge.penal_code }} {{ charge.label }}{% endblock %}

{% block breadcrumbs %}
{% for p in charge.parents %}&raquo;<a href="{{p.get_absolute_url}}">{{ p.penal_code }} {{ p.label }}</a>{% endfor %}
{% endblock %}

{% block content %}
{{ block.super }}


<h1>{{ charge.penal_code }} {{ charge.label }}</h1>


  {% if charge.children %}
<ul>
{% for charge in charge.children %}
{{ charge.as_view_ul|safe }}
{% endfor %}
</ul>
{% endif %}

  {% if charge.view_all %}

<table class="categories">
  <tr>
    <th class="yes">yes</th>
    <th class="probably">probably</th>
    <th class="maybe">maybe</th></tr>
  <tr>
    <td>
      <ul>
	{% for cc in charge.view_yes %}
	<li><a href="{{cc.classification.get_absolute_url}}">{{ cc.classification.label }}</a>
	  <ul>
	    {% for clco in cc.classification.classificationconsequence_set.all %}
	    <li><a href="{{clco.consequence.area.get_absolute_url}}">{{ clco.consequence.area.label }}</a>: <a href="{{clco.consequence.get_absolute_url}}">{{ clco.consequence.label }}</a></li>
	    {% endfor %}
	  </ul>
	</li>
	{% endfor %}
      </ul>
    </td>

    <td>
      <ul>
	{% for cc in charge.view_probably %}
	<li><a href="{{cc.classification.get_absolute_url}}">{{ cc.classification.label }}</a>
	  <ul>
	    {% for clco in cc.classification.classificationconsequence_set.all %}
	    <li><a href="{{clco.consequence.area.get_absolute_url}}">{{ clco.consequence.area.label }}</a>: <a href="{{clco.consequence.get_absolute_url}}">{{ clco.consequence.label }}</a></li>
	    {% endfor %}
	  </ul>
	</li>
	{% endfor %}
      </ul>
    </td>

    <td>
      <ul>
	{% for cc in charge.view_maybe %}
	<li><a href="{{cc.classification.get_absolute_url}}">{{ cc.classification.label }}</a> 
	  <ul>
	    {% for clco in cc.classification.classificationconsequence_set.all %}
	    <li><a href="{{clco.consequence.area.get_absolute_url}}">{{ clco.consequence.area.label }}</a>: <a href="{{clco.consequence.get_absolute_url}}">{{ clco.consequence.label }}</a></li>
	    {% endfor %}
	  </ul>
	</li>
	{% endfor %}
      </ul>
    </td>
  </tr>

</table>

{% else %}

{% if not charge.children %}
{# only show message if this is a leaf charge #}
<p>There are no consequences listed for this charge</p>
{% endif %}
{% endif %}

{% if not charge.children and charge.no_areas %}
<p>This charge has not been vetted for the following areas:</p>

<ul>
{% for area in charge.no_areas %}
<li>{{ area.label }}</li>
{% endfor %}
</ul>
{% endif %}

{% endblock %}
